(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
'use strict';

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

var _utilsAjax = require('./utils/Ajax');

var _utilsAjax2 = _interopRequireDefault(_utilsAjax);

var _optimizationsTree = require('./optimizations/Tree');

var _optimizationsTree2 = _interopRequireDefault(_optimizationsTree);

var _busBranch = require('./bus/Branch');

var _busBranch2 = _interopRequireDefault(_busBranch);

var _busTrail = require('./bus/Trail');

var _busTrail2 = _interopRequireDefault(_busTrail);

var _busRank = require('./bus/Rank');

var _busRank2 = _interopRequireDefault(_busRank);

var _utilsGrid = require('./utils/Grid');

var _utilsGrid2 = _interopRequireDefault(_utilsGrid);

var _uiTerrain = require('./ui/Terrain');

var _uiTerrain2 = _interopRequireDefault(_uiTerrain);

_utilsAjax2['default'].get('../data/map2.txt').then(init);

function init(data) {
  console.time('process');
  var list = data.split(' ');

  var matrix = [];
  var count = 0;

  for (var i = 0; i < 4; i++) {
    matrix[i] = [];
    for (var j = 0; j < 4; j++) {
      matrix[i].push(parseInt(list[count]));
      count++;
    }
  }

  for (var i = 0; i < matrix.length; i++) {
    for (var j = 0; j < matrix.length; j++) {
      if (!_optimizationsTree2['default'].get(i, j)) {
        _busBranch2['default'].walk(matrix, i, j, matrix[i][j], (0, _busTrail2['default'])());
      }
    }
  }

  var grid = _utilsGrid2['default'].create(matrix);

  /*
   * TODO: need to improve this method and the terrain generation
   * Pass true to fix the grid size.
   */
  var terrain = new _uiTerrain2['default'](grid.grid, grid.path, grid.rowStart, grid.colStart, true);

  console.timeEnd('process');
  console.log(_busRank2['default'].result(matrix));
}

},{"./bus/Branch":2,"./bus/Rank":3,"./bus/Trail":4,"./optimizations/Tree":6,"./ui/Terrain":7,"./utils/Ajax":8,"./utils/Grid":10}],2:[function(require,module,exports){
'use strict';

var Memoization = require('../optimizations/Memoization'),
    Tree = require('../optimizations/Tree'),
    Rank = require('../bus/Rank'),
    trail = require('../bus/Trail.js');

var Branch = {
  getEdge: function getEdge(matrix, row, column) {
    if (matrix[row] === undefined || matrix[row][column] === undefined) {
      return null;
    }

    return {
      row: row,
      column: column,
      value: matrix[row][column]
    };
  },

  getEdgeValues: function getEdgeValues(matrix, row, column) {
    var left = this.getEdge(matrix, row, column - 1),
        right = this.getEdge(matrix, row, column + 1),
        bottom = this.getEdge(matrix, row + 1, column),
        top = this.getEdge(matrix, row - 1, column);

    return {
      left: left, right: right, bottom: bottom, top: top
    };
  },

  walk: function walk(matrix, row, column, value, tail) {
    var branches = this.getEdgeValues(matrix, row, column);

    var count = 0;
    Object.keys(branches).forEach(function (key) {
      var item = branches[key];

      if (item && value > item.value) {
        var memo = Memoization.get(item.row, item.column);
        if (memo) {
          var trace = trail(tail.get());
          trace.add(row, column);

          trace = trace.get().concat(memo);

          Memoization.add(matrix, trace);
          Rank.add(matrix, trace);
          count++;
        } else {
          var trace = trail(tail.get());
          trace.add(row, column);

          Branch.walk(matrix, item.row, item.column, item.value, trace);

          count++;
        }
      }
    });

    if (count === 0) {
      var trace = trail(tail.get());
      trace.add(row, column);

      var history = trace.get();

      Rank.add(matrix, history);

      Memoization.add(matrix, history.slice(1, history.length));
    } else {
      Tree.add(row, column, value);
    }
  }
};

module.exports = Branch;

},{"../bus/Rank":3,"../bus/Trail.js":4,"../optimizations/Memoization":5,"../optimizations/Tree":6}],3:[function(require,module,exports){
'use strict';

var Drop = require('../utils/Drop');

var _store = [];

var Rank = {
  add: function add(matrix, trail) {
    if (_store.length === 0 || Drop.isHigher(matrix, trail, _store)) {
      _store = trail;
    }
  },

  get: function get() {
    return _store;
  },

  result: function result(matrix) {
    return {
      length: _store.length,
      drop: Drop.dropCalculation(matrix, _store)
    };
  }
};

module.exports = Rank;

},{"../utils/Drop":9}],4:[function(require,module,exports){
'use strict';

var Trail = function Trail(list) {
  var _store = [];

  if (list) {
    _store = _store.concat(list);
  }

  return {
    get: function get() {
      return _store;
    },

    add: function add(row, column) {
      _store.push([row, column]);
    },

    push: function push(row, column) {
      _store.unshift([row, column]);
    }
  };
};

module.exports = Trail;

},{}],5:[function(require,module,exports){
'use strict';

var Identity = require('../utils/Identity'),
    Matrix = require('../utils/Matrix'),
    Drop = require('../utils/Drop');

var _store = new Map();

var Memoization = {
  add: function add(matrix, trail) {
    if (!trail[0]) {
      return;
    }

    var trailPos = Matrix.getPosition(trail[0]),
        key = Identity.getKey(trailPos.row, trailPos.column);

    var memo = _store.get(key);
    if (memo) {
      if (Drop.isHigher(matrix, trail, memo)) {
        _store.set(key, trail);
      }
    } else {
      _store.set(key, trail);
    }
  },

  get: function get(row, column) {
    var key = Identity.getKey(row, column);

    return _store.get(key);
  }
};

module.exports = Memoization;

},{"../utils/Drop":9,"../utils/Identity":11,"../utils/Matrix":12}],6:[function(require,module,exports){
'use strict';

var Identity = require('../utils/Identity');

var _store = new Map();

var Tree = {
  add: function add(row, column, value) {
    var key = Identity.getKey(row, column);

    _store.set(key, value);
  },

  get: function get(row, column) {
    var key = Identity.getKey(row, column);

    return _store.get(key);
  }
};

module.exports = Tree;

},{"../utils/Identity":11}],7:[function(require,module,exports){
/*eslint-disable */

'use strict';

var Terrain = function Terrain(matrix, path, rowStart, colStart, normalize) {

  var width = window.innerWidth,
      height = window.innerHeight;

  var scene = new THREE.Scene();

  //var axes = new THREE.AxisHelper(200);
  //scene.add(axes);

  var camera = new THREE.PerspectiveCamera(45, width / height, 0.1, 1000);
  camera.position.set(0, -50, 50);

  var renderer = new THREE.WebGLRenderer();
  renderer.setClearColor(0xebebeb);
  renderer.setSize(width, height);

  var light = new THREE.AmbientLight(0x404040); // soft white light
  scene.add(light);

  var geometry = new THREE.PlaneGeometry(300, 300, matrix.length - 1, matrix.length - 1);

  for (var i = 0, l = geometry.vertices.length; i < l; i++) {
    var row = Math.floor(i / matrix.length);
    geometry.vertices[i].z = normalizeHeight(matrix[row][Math.floor(i % matrix[row].length)], normalize);
  }

  var map = new Map();
  var faceIndices = ['a', 'b', 'c', 'd'];
  var radius = 200;

  for (var i = 0; i < geometry.faces.length; i++) {
    var face = geometry.faces[i];

    var n = face instanceof THREE.Face3 ? 3 : 4;

    for (var j = 0; j < n; j++) {
      var vertexIndex = face[faceIndices[j]];

      var p = geometry.vertices[vertexIndex];
      var color = new THREE.Color(0xffffff);

      var value = 0;
      var found = path.some(function (item) {
        if (normalizeHeight(matrix[item[0] - rowStart][item[1] - colStart], normalize) == p.z) {
          return true;
        }

        return false;
      });

      if (found) {
        color.setHSL(0.200 * vertexIndex / geometry.vertices.length, 1.0, 0.5);

        map.set(p.z, p);
      } else {
        color.setHSL(0.0, (p.y / radius + 1) / 2, 0.2);
      }

      face.vertexColors[j] = color;
    }
  }

  //    var material = new THREE.MeshPhongMaterial({
  //        color: 0xdddddd,
  //        wireframe: true
  //    });

  var materials = [new THREE.MeshLambertMaterial({ color: 0xffffff, shading: THREE.FlatShading, vertexColors: THREE.VertexColors }), new THREE.MeshBasicMaterial({ color: 0x000000, shading: THREE.FlatShading, wireframe: true, transparent: true })];

  // var plane = new THREE.Mesh(geometry, material);
  var plane = THREE.SceneUtils.createMultiMaterialObject(geometry, materials);

  var points = {};

  map.forEach(function (data, key) {
    points[key] = data;
  });

  var points = Object.keys(points).sort(function (a, b) {
    return a - b;
  }).map(function (a) {
    return points[a];
  });

  console.log(points);

  var lineGeometry = new THREE.Geometry();

  Object.keys(points).forEach(function (a) {
    lineGeometry.vertices.push(new THREE.Vector3(points[a].x, points[a].y, points[a].z + 20));
  });

  var line = new THREE.Line(lineGeometry, new THREE.LineBasicMaterial({
    color: 0x00ff00,
    linewidth: 5
  }));

  plane.add(line);

  scene.add(plane);

  var controls = new THREE.TrackballControls(camera);

  document.getElementById('webgl').appendChild(renderer.domElement);

  render();

  function render() {
    controls.update();
    requestAnimationFrame(render);
    renderer.render(scene, camera);
  }

  function normalizeHeight(value, normalize) {
    if (!normalize) {
      return value * 15;
    }

    var result = Math.round(value / 65535 * 2470);

    return result > 0 ? result : value;
  }
};

module.exports = Terrain;

/*eslint-enable */

},{}],8:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, '__esModule', {
  value: true
});
var Ajax = {
  get: function get(url) {
    // Return a new promise.
    return new Promise(function (resolve, reject) {
      // Do the usual XHR stuff
      var req = new XMLHttpRequest();
      req.open('GET', url);

      req.onload = function () {
        // This is called even on 404 etc
        // so check the status
        if (req.status === 200) {
          // Resolve the promise with the response text
          resolve(req.response);
        } else {
          // Otherwise reject with the status text
          // which will hopefully be a meaningful error
          reject(Error(req.statusText));
        }
      };

      // Handle network errors
      req.onerror = function () {
        reject(Error('Network Error'));
      };

      // Make the request
      req.send();
    });
  }
};

exports['default'] = Ajax;
module.exports = exports['default'];

},{}],9:[function(require,module,exports){
'use strict';

var Matrix = require('./Matrix');

var Drop = {
  dropCalculation: function dropCalculation(matrix, trail) {
    return Matrix.getValue(matrix, trail[0]) - Matrix.getValue(matrix, trail[trail.length - 1]);
  },

  isHigher: function isHigher(matrix, newTrail, currentTrail) {
    var currentDrop = this.dropCalculation(matrix, currentTrail),
        trailDrop = this.dropCalculation(matrix, newTrail);

    if (newTrail.length === currentTrail.length && trailDrop > currentDrop) {
      return true;
    } else if (newTrail.length > currentTrail.length) {
      return true;
    }

    return false;
  }
};

module.exports = Drop;

},{"./Matrix":12}],10:[function(require,module,exports){
'use strict';

var Rank = require('../bus/Rank');

module.exports = {
  create: function create(matrix) {
    var length = Rank.result(matrix).length;
    var path = Rank.get();

    var half = path[Math.floor((path.length - 1) / 2)];

    var rowStart = half[0] - length;
    if (half[0] - length < 0) {
      rowStart = 0;
    }

    var rowEnd = half[0] + length;
    if (half[0] + length > matrix.length - 1) {
      rowEnd = matrix.length;
    }

    var colStart = half[1] - length;
    if (half[1] - length < 0) {
      colStart = 0;
    }

    var colEnd = half[1] + length;
    if (half[1] + length > matrix.length - 1) {
      colEnd = matrix.length;
    }

    var grid = [];
    var count = 0;
    for (var i = rowStart; i < rowEnd; i++) {
      grid[count] = [];
      for (var j = colStart; j < colEnd; j++) {
        grid[count].push(matrix[i][j]);
      }

      count++;
    }

    return {
      rowStart: rowStart,
      colStart: colStart,
      grid: grid,
      path: path
    };
  }
};

},{"../bus/Rank":3}],11:[function(require,module,exports){
'use strict';

module.exports = {
  getKey: function getKey(row, column) {
    return '_' + row + '_' + column;
  }
};

},{}],12:[function(require,module,exports){
'use strict';

module.exports = {
  getValue: function getValue(matrix, cell) {
    var position = this.getPosition(cell);

    return matrix[position.row][position.column];
  },

  getPosition: function getPosition(cell) {
    return {
      row: cell[0],
      column: cell[1]
    };
  }
};

},{}]},{},[1])
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlc1xcYnJvd3NlcmlmeVxcbm9kZV9tb2R1bGVzXFxicm93c2VyLXBhY2tcXF9wcmVsdWRlLmpzIiwiRDovZGV2L3NraWluZy9hcHAvc2NyaXB0cy9tYWluLmpzIiwiRDovZGV2L3NraWluZy9hcHAvc2NyaXB0cy9idXMvQnJhbmNoLmpzIiwiRDovZGV2L3NraWluZy9hcHAvc2NyaXB0cy9idXMvUmFuay5qcyIsIkQ6L2Rldi9za2lpbmcvYXBwL3NjcmlwdHMvYnVzL1RyYWlsLmpzIiwiRDovZGV2L3NraWluZy9hcHAvc2NyaXB0cy9vcHRpbWl6YXRpb25zL01lbW9pemF0aW9uLmpzIiwiRDovZGV2L3NraWluZy9hcHAvc2NyaXB0cy9vcHRpbWl6YXRpb25zL1RyZWUuanMiLCJEOi9kZXYvc2tpaW5nL2FwcC9zY3JpcHRzL3VpL1RlcnJhaW4uanMiLCJEOi9kZXYvc2tpaW5nL2FwcC9zY3JpcHRzL3V0aWxzL0FqYXguanMiLCJEOi9kZXYvc2tpaW5nL2FwcC9zY3JpcHRzL3V0aWxzL0Ryb3AuanMiLCJEOi9kZXYvc2tpaW5nL2FwcC9zY3JpcHRzL3V0aWxzL0dyaWQuanMiLCJEOi9kZXYvc2tpaW5nL2FwcC9zY3JpcHRzL3V0aWxzL0lkZW50aXR5LmpzIiwiRDovZGV2L3NraWluZy9hcHAvc2NyaXB0cy91dGlscy9NYXRyaXguanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQSxZQUFZLENBQUM7Ozs7eUJBRUksY0FBYzs7OztpQ0FFZCxzQkFBc0I7Ozs7eUJBRXBCLGNBQWM7Ozs7d0JBQ2YsYUFBYTs7Ozt1QkFDZCxZQUFZOzs7O3lCQUVaLGNBQWM7Ozs7eUJBRVgsY0FBYzs7OztBQUdsQyx1QkFBSyxHQUFHLENBQUMsa0JBQWtCLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7O0FBRXhDLFNBQVMsSUFBSSxDQUFDLElBQUksRUFBRTtBQUNsQixTQUFPLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFD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QUFJLENBQUMsQ0FBQyxDQUFDO0FBQ1osWUFBTSxFQUFFLElBQUksQ0FBQyxDQUFDLENBQUM7S0FDaEIsQ0FBQztHQUNIO0NBQ0YsQ0FBQyIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCIndXNlIHN0cmljdCc7XG5cbmltcG9ydCBBamF4IGZyb20gJy4vdXRpbHMvQWpheCc7XG5cbmltcG9ydCBUcmVlIGZyb20gJy4vb3B0aW1pemF0aW9ucy9UcmVlJztcblxuaW1wb3J0IEJyYW5jaCBmcm9tICcuL2J1cy9CcmFuY2gnO1xuaW1wb3J0IHRyYWlsIGZyb20gJy4vYnVzL1RyYWlsJztcbmltcG9ydCBSYW5rIGZyb20gJy4vYnVzL1JhbmsnO1xuXG5pbXBvcnQgR3JpZCBmcm9tICcuL3V0aWxzL0dyaWQnO1xuXG5pbXBvcnQgVGVycmFpbiBmcm9tICcuL3VpL1RlcnJhaW4nO1xuXG5cbkFqYXguZ2V0KCcuLi9kYXRhL21hcDIudHh0JykudGhlbihpbml0KTtcblxuZnVuY3Rpb24gaW5pdChkYXRhKSB7XG4gIGNvbnNvbGUudGltZSgncHJvY2VzcycpO1xuICBsZXQgbGlzdCA9IGRhdGEuc3BsaXQoJyAnKTtcblxuICBsZXQgbWF0cml4ID0gW107XG4gIGxldCBjb3VudCA9IDA7XG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCA0OyBpKyspIHtcbiAgICBtYXRyaXhbaV0gPSBbXTtcbiAgICBmb3IgKHZhciBqID0gMDsgaiA8IDQ7IGorKykge1xuICAgICAgbWF0cml4W2ldLnB1c2gocGFyc2VJbnQobGlzdFtjb3VudF0pKTtcbiAgICAgIGNvdW50Kys7XG4gICAgfVxuICB9XG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBtYXRyaXgubGVuZ3RoOyBpKyspIHtcbiAgICBmb3IgKHZhciBqID0gMDsgaiA8IG1hdHJpeC5sZW5ndGg7IGorKykge1xuICAgICAgaWYgKCFUcmVlLmdldChpLCBqKSkge1xuICAgICAgICBCcmFuY2gud2FsayhtYXRyaXgsIGksIGosIG1hdHJpeFtpXVtqXSwgdHJhaWwoKSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgbGV0IGdyaWQgPSBHcmlkLmNyZWF0ZShtYXRyaXgpO1xuXG4gIC8qXG4gICAqIFRPRE86IG5lZWQgdG8gaW1wcm92ZSB0aGlzIG1ldGhvZCBhbmQgdGhlIHRlcnJhaW4gZ2VuZXJhdGlvblxuICAgKiBQYXNzIHRydWUgdG8gZml4IHRoZSBncmlkIHNpemUuXG4gICAqL1xuICB2YXIgdGVycmFpbiA9IG5ldyBUZXJyYWluKGdyaWQuZ3JpZCwgZ3JpZC5wYXRoLCBncmlkLnJvd1N0YXJ0LCBncmlkLmNvbFN0YXJ0LCB0cnVlKTtcblxuICBjb25zb2xlLnRpbWVFbmQoJ3Byb2Nlc3MnKTtcbiAgY29uc29sZS5sb2coUmFuay5yZXN1bHQobWF0cml4KSk7XG59XG4iLCIndXNlIHN0cmljdCc7XG5cbmxldCBNZW1vaXphdGlvbiA9IHJlcXVpcmUoJy4uL29wdGltaXphdGlvbnMvTWVtb2l6YXRpb24nKVxuICAsIFRyZWUgPSByZXF1aXJlKCcuLi9vcHRpbWl6YXRpb25zL1RyZWUnKVxuICAsIFJhbmsgPSByZXF1aXJlKCcuLi9idXMvUmFuaycpXG4gICwgdHJhaWwgPSByZXF1aXJlKCcuLi9idXMvVHJhaWwuanMnKTtcblxubGV0IEJyYW5jaCA9IHtcbiAgZ2V0RWRnZShtYXRyaXgsIHJvdywgY29sdW1uKSB7XG4gICAgaWYgKG1hdHJpeFtyb3ddID09PSB1bmRlZmluZWQgfHwgbWF0cml4W3Jvd11bY29sdW1uXSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgcm93OiByb3csXG4gICAgICBjb2x1bW46IGNvbHVtbixcbiAgICAgIHZhbHVlOiBtYXRyaXhbcm93XVtjb2x1bW5dXG4gICAgfTtcbiAgfSxcblxuXG4gIGdldEVkZ2VWYWx1ZXMobWF0cml4LCByb3csIGNvbHVtbikge1xuICAgIGxldCBsZWZ0ID0gdGhpcy5nZXRFZGdlKG1hdHJpeCwgcm93LCBjb2x1bW4gLSAxKVxuICAgICAgLCByaWdodCA9IHRoaXMuZ2V0RWRnZShtYXRyaXgsIHJvdywgY29sdW1uICsgMSlcbiAgICAgICwgYm90dG9tID0gdGhpcy5nZXRFZGdlKG1hdHJpeCwgcm93ICsgMSwgY29sdW1uKVxuICAgICAgLCB0b3AgPSB0aGlzLmdldEVkZ2UobWF0cml4LCByb3cgLSAxLCBjb2x1bW4pO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIGxlZnQsIHJpZ2h0LCBib3R0b20sIHRvcFxuICAgIH07XG4gIH0sXG5cbiAgd2FsayhtYXRyaXgsIHJvdywgY29sdW1uLCB2YWx1ZSwgdGFpbCkge1xuICAgIGxldCBicmFuY2hlcyA9IHRoaXMuZ2V0RWRnZVZhbHVlcyhtYXRyaXgsIHJvdywgY29sdW1uKTtcblxuICAgIGxldCBjb3VudCA9IDA7XG4gICAgT2JqZWN0LmtleXMoYnJhbmNoZXMpLmZvckVhY2goKGtleSkgPT4ge1xuICAgICAgbGV0IGl0ZW0gPSBicmFuY2hlc1trZXldO1xuXG4gICAgICBpZiAoaXRlbSAmJiB2YWx1ZSA+IGl0ZW0udmFsdWUpIHtcbiAgICAgICAgdmFyIG1lbW8gPSBNZW1vaXphdGlvbi5nZXQoaXRlbS5yb3csIGl0ZW0uY29sdW1uKTtcbiAgICAgICAgaWYgKG1lbW8pIHtcbiAgICAgICAgICBsZXQgdHJhY2UgPSB0cmFpbCh0YWlsLmdldCgpKTtcbiAgICAgICAgICB0cmFjZS5hZGQocm93LCBjb2x1bW4pO1xuXG4gICAgICAgICAgdHJhY2UgPSB0cmFjZS5nZXQoKS5jb25jYXQobWVtbyk7XG5cblxuICAgICAgICAgIE1lbW9pemF0aW9uLmFkZChtYXRyaXgsIHRyYWNlKTtcbiAgICAgICAgICBSYW5rLmFkZChtYXRyaXgsIHRyYWNlKTtcbiAgICAgICAgICBjb3VudCsrO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGxldCB0cmFjZSA9IHRyYWlsKHRhaWwuZ2V0KCkpO1xuICAgICAgICAgIHRyYWNlLmFkZChyb3csIGNvbHVtbik7XG5cbiAgICAgICAgICBCcmFuY2gud2FsayhtYXRyaXgsIGl0ZW0ucm93LCBpdGVtLmNvbHVtbiwgaXRlbS52YWx1ZSwgdHJhY2UpO1xuXG4gICAgICAgICAgY291bnQrKztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaWYgKGNvdW50ID09PSAwKSB7XG4gICAgICBsZXQgdHJhY2UgPSB0cmFpbCh0YWlsLmdldCgpKTtcbiAgICAgIHRyYWNlLmFkZChyb3csIGNvbHVtbik7XG5cbiAgICAgIHZhciBoaXN0b3J5ID0gdHJhY2UuZ2V0KCk7XG5cbiAgICAgIFJhbmsuYWRkKG1hdHJpeCwgaGlzdG9yeSk7XG5cbiAgICAgIE1lbW9pemF0aW9uLmFkZChtYXRyaXgsIGhpc3Rvcnkuc2xpY2UoMSwgaGlzdG9yeS5sZW5ndGgpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgVHJlZS5hZGQocm93LCBjb2x1bW4sIHZhbHVlKTtcbiAgICB9XG4gIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gQnJhbmNoO1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG5sZXQgRHJvcCA9IHJlcXVpcmUoJy4uL3V0aWxzL0Ryb3AnKTtcblxubGV0IF9zdG9yZSA9IFtdO1xuXG5sZXQgUmFuayA9IHtcbiAgYWRkKG1hdHJpeCwgdHJhaWwpIHtcbiAgICBpZiAoX3N0b3JlLmxlbmd0aCA9PT0gMCB8fCBEcm9wLmlzSGlnaGVyKG1hdHJpeCwgdHJhaWwsIF9zdG9yZSkpIHtcbiAgICAgIF9zdG9yZSA9IHRyYWlsO1xuICAgIH1cbiAgfSxcblxuICBnZXQoKSB7XG4gICAgcmV0dXJuIF9zdG9yZTtcbiAgfSxcblxuICByZXN1bHQobWF0cml4KSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGxlbmd0aDogX3N0b3JlLmxlbmd0aCxcbiAgICAgIGRyb3A6IERyb3AuZHJvcENhbGN1bGF0aW9uKG1hdHJpeCwgX3N0b3JlKVxuICAgIH07XG4gIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gUmFuaztcblxuIiwiJ3VzZSBzdHJpY3QnO1xuXG5sZXQgVHJhaWwgPSBmdW5jdGlvbihsaXN0KSB7XG4gIGxldCBfc3RvcmUgPSBbXTtcblxuICBpZiAobGlzdCkge1xuICAgIF9zdG9yZSA9IF9zdG9yZS5jb25jYXQobGlzdCk7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gX3N0b3JlO1xuICAgIH0sXG5cbiAgICBhZGQ6IGZ1bmN0aW9uKHJvdywgY29sdW1uKSB7XG4gICAgICBfc3RvcmUucHVzaChbcm93LCBjb2x1bW5dKTtcbiAgICB9LFxuXG4gICAgcHVzaDogZnVuY3Rpb24ocm93LCBjb2x1bW4pIHtcbiAgICAgIF9zdG9yZS51bnNoaWZ0KFtyb3csIGNvbHVtbl0pO1xuICAgIH1cbiAgfTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gVHJhaWw7XG4iLCIndXNlIHN0cmljdCc7XG5cbmxldCBJZGVudGl0eSA9IHJlcXVpcmUoJy4uL3V0aWxzL0lkZW50aXR5JylcbiAgLCBNYXRyaXggPSByZXF1aXJlKCcuLi91dGlscy9NYXRyaXgnKVxuICAsIERyb3AgPSByZXF1aXJlKCcuLi91dGlscy9Ecm9wJyk7XG5cbmxldCBfc3RvcmUgPSBuZXcgTWFwKCk7XG5cbmxldCBNZW1vaXphdGlvbiA9IHtcbiAgYWRkKG1hdHJpeCwgdHJhaWwpIHtcbiAgICBpZiAoIXRyYWlsWzBdKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgdHJhaWxQb3MgPSBNYXRyaXguZ2V0UG9zaXRpb24odHJhaWxbMF0pXG4gICAgICAsIGtleSA9IElkZW50aXR5LmdldEtleSh0cmFpbFBvcy5yb3csIHRyYWlsUG9zLmNvbHVtbik7XG5cbiAgICBsZXQgbWVtbyA9IF9zdG9yZS5nZXQoa2V5KTtcbiAgICBpZiAobWVtbykge1xuICAgICAgaWYgKERyb3AuaXNIaWdoZXIobWF0cml4LCB0cmFpbCwgbWVtbykpIHtcbiAgICAgICAgX3N0b3JlLnNldChrZXksIHRyYWlsKTtcbiAgICAgIH1cblxuICAgIH0gZWxzZSB7XG4gICAgICBfc3RvcmUuc2V0KGtleSwgdHJhaWwpO1xuICAgIH1cbiAgfSxcblxuICBnZXQocm93LCBjb2x1bW4pIHtcbiAgICBjb25zdCBrZXkgPSBJZGVudGl0eS5nZXRLZXkocm93LCBjb2x1bW4pO1xuXG4gICAgcmV0dXJuIF9zdG9yZS5nZXQoa2V5KTtcbiAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBNZW1vaXphdGlvbjtcblxuIiwiJ3VzZSBzdHJpY3QnO1xuXG5sZXQgSWRlbnRpdHkgPSByZXF1aXJlKCcuLi91dGlscy9JZGVudGl0eScpO1xuXG5sZXQgX3N0b3JlID0gbmV3IE1hcCgpO1xuXG5sZXQgVHJlZSA9IHtcbiAgYWRkKHJvdywgY29sdW1uLCB2YWx1ZSkge1xuICAgIGNvbnN0IGtleSA9IElkZW50aXR5LmdldEtleShyb3csIGNvbHVtbik7XG5cbiAgICBfc3RvcmUuc2V0KGtleSwgdmFsdWUpO1xuICB9LFxuXG4gIGdldChyb3csIGNvbHVtbikge1xuICAgIGNvbnN0IGtleSA9IElkZW50aXR5LmdldEtleShyb3csIGNvbHVtbik7XG5cbiAgICByZXR1cm4gX3N0b3JlLmdldChrZXkpO1xuICB9XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IFRyZWU7XG5cbiIsIi8qZXNsaW50LWRpc2FibGUgKi9cblxudmFyIFRlcnJhaW4gPSBmdW5jdGlvbiAobWF0cml4LCBwYXRoLCByb3dTdGFydCwgY29sU3RhcnQsIG5vcm1hbGl6ZSkge1xuXG4gIHZhciB3aWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoLFxuICAgIGhlaWdodCA9IHdpbmRvdy5pbm5lckhlaWdodDtcblxuICB2YXIgc2NlbmUgPSBuZXcgVEhSRUUuU2NlbmUoKTtcblxuICAvL3ZhciBheGVzID0gbmV3IFRIUkVFLkF4aXNIZWxwZXIoMjAwKTtcbiAgLy9zY2VuZS5hZGQoYXhlcyk7XG5cbiAgdmFyIGNhbWVyYSA9IG5ldyBUSFJFRS5QZXJzcGVjdGl2ZUNhbWVyYSg0NSwgd2lkdGggLyBoZWlnaHQsIDAuMSwgMTAwMCk7XG4gIGNhbWVyYS5wb3NpdGlvbi5zZXQoMCwgLTUwLCA1MCk7XG5cbiAgdmFyIHJlbmRlcmVyID0gbmV3IFRIUkVFLldlYkdMUmVuZGVyZXIoKTtcbiAgcmVuZGVyZXIuc2V0Q2xlYXJDb2xvcigweGViZWJlYik7XG4gIHJlbmRlcmVyLnNldFNpemUod2lkdGgsIGhlaWdodCk7XG5cbiAgdmFyIGxpZ2h0ID0gbmV3IFRIUkVFLkFtYmllbnRMaWdodCgweDQwNDA0MCk7IC8vIHNvZnQgd2hpdGUgbGlnaHRcbiAgc2NlbmUuYWRkKGxpZ2h0KTtcblxuXG4gIHZhciBnZW9tZXRyeSA9IG5ldyBUSFJFRS5QbGFuZUdlb21ldHJ5KDMwMCwgMzAwLCBtYXRyaXgubGVuZ3RoIC0gMSwgbWF0cml4Lmxlbmd0aCAtIDEpO1xuXG4gIGZvciAodmFyIGkgPSAwLCBsID0gZ2VvbWV0cnkudmVydGljZXMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgdmFyIHJvdyA9IE1hdGguZmxvb3IoaSAvIG1hdHJpeC5sZW5ndGgpO1xuICAgIGdlb21ldHJ5LnZlcnRpY2VzW2ldLnogPSBub3JtYWxpemVIZWlnaHQobWF0cml4W3Jvd11bTWF0aC5mbG9vcihpICUgbWF0cml4W3Jvd10ubGVuZ3RoKV0sIG5vcm1hbGl6ZSk7XG4gIH1cblxuICB2YXIgbWFwID0gbmV3IE1hcCgpO1xuICB2YXIgZmFjZUluZGljZXMgPSBbJ2EnLCAnYicsICdjJywgJ2QnXTtcbiAgdmFyIHJhZGl1cyA9IDIwMDtcblxuICBmb3IgKHZhciBpID0gMDsgaSA8IGdlb21ldHJ5LmZhY2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgdmFyIGZhY2UgPSBnZW9tZXRyeS5mYWNlc1tpXTtcblxuICAgIHZhciBuID0gKCBmYWNlIGluc3RhbmNlb2YgVEhSRUUuRmFjZTMgKSA/IDMgOiA0O1xuXG4gICAgZm9yICh2YXIgaiA9IDA7IGogPCBuOyBqKyspIHtcbiAgICAgIHZhciB2ZXJ0ZXhJbmRleCA9IGZhY2VbZmFjZUluZGljZXNbal1dO1xuXG4gICAgICB2YXIgcCA9IGdlb21ldHJ5LnZlcnRpY2VzW3ZlcnRleEluZGV4XTtcbiAgICAgIHZhciBjb2xvciA9IG5ldyBUSFJFRS5Db2xvcigweGZmZmZmZik7XG5cbiAgICAgIHZhciB2YWx1ZSA9IDA7XG4gICAgICB2YXIgZm91bmQgPSBwYXRoLnNvbWUoZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgaWYgKG5vcm1hbGl6ZUhlaWdodChtYXRyaXhbaXRlbVswXSAtIHJvd1N0YXJ0XVtpdGVtWzFdIC0gY29sU3RhcnRdLCBub3JtYWxpemUpID09IHAueikge1xuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfSk7XG5cbiAgICAgIGlmIChmb3VuZCkge1xuICAgICAgICBjb2xvci5zZXRIU0woMC4yMDAgKiB2ZXJ0ZXhJbmRleCAvIGdlb21ldHJ5LnZlcnRpY2VzLmxlbmd0aCwgMS4wLCAwLjUpO1xuXG4gICAgICAgIG1hcC5zZXQocC56LCBwKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbG9yLnNldEhTTCgwLjAsICggcC55IC8gcmFkaXVzICsgMSApIC8gMiwgMC4yKTtcbiAgICAgIH1cblxuICAgICAgZmFjZS52ZXJ0ZXhDb2xvcnNbal0gPSBjb2xvcjtcbiAgICB9XG4gIH1cblxuICAvLyAgICB2YXIgbWF0ZXJpYWwgPSBuZXcgVEhSRUUuTWVzaFBob25nTWF0ZXJpYWwoe1xuICAvLyAgICAgICAgY29sb3I6IDB4ZGRkZGRkLFxuICAvLyAgICAgICAgd2lyZWZyYW1lOiB0cnVlXG4gIC8vICAgIH0pO1xuXG4gIHZhciBtYXRlcmlhbHMgPSBbXG5cbiAgICBuZXcgVEhSRUUuTWVzaExhbWJlcnRNYXRlcmlhbCh7Y29sb3I6IDB4ZmZmZmZmLCBzaGFkaW5nOiBUSFJFRS5GbGF0U2hhZGluZywgdmVydGV4Q29sb3JzOiBUSFJFRS5WZXJ0ZXhDb2xvcnN9KSxcbiAgICBuZXcgVEhSRUUuTWVzaEJhc2ljTWF0ZXJpYWwoe2NvbG9yOiAweDAwMDAwMCwgc2hhZGluZzogVEhSRUUuRmxhdFNoYWRpbmcsIHdpcmVmcmFtZTogdHJ1ZSwgdHJhbnNwYXJlbnQ6IHRydWV9KVxuXG4gIF07XG5cbiAgLy8gdmFyIHBsYW5lID0gbmV3IFRIUkVFLk1lc2goZ2VvbWV0cnksIG1hdGVyaWFsKTtcbiAgdmFyIHBsYW5lID0gVEhSRUUuU2NlbmVVdGlscy5jcmVhdGVNdWx0aU1hdGVyaWFsT2JqZWN0KGdlb21ldHJ5LCBtYXRlcmlhbHMpO1xuXG5cbiAgdmFyIHBvaW50cyA9IHt9O1xuXG4gIG1hcC5mb3JFYWNoKGZ1bmN0aW9uIChkYXRhLCBrZXkpIHtcbiAgICBwb2ludHNba2V5XSA9IGRhdGE7XG4gIH0pO1xuXG4gIHZhciBwb2ludHMgPSBPYmplY3Qua2V5cyhwb2ludHMpLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHtcbiAgICByZXR1cm4gYSAtIGI7XG4gIH0pLm1hcChmdW5jdGlvbiAoYSkge1xuICAgIHJldHVybiBwb2ludHNbYV07XG4gIH0pO1xuXG5cbiAgY29uc29sZS5sb2cocG9pbnRzKTtcblxuICB2YXIgbGluZUdlb21ldHJ5ID0gbmV3IFRIUkVFLkdlb21ldHJ5KCk7XG5cbiAgT2JqZWN0LmtleXMocG9pbnRzKS5mb3JFYWNoKGZ1bmN0aW9uIChhKSB7XG4gICAgbGluZUdlb21ldHJ5LnZlcnRpY2VzLnB1c2gobmV3IFRIUkVFLlZlY3RvcjMocG9pbnRzW2FdLngsIHBvaW50c1thXS55LCBwb2ludHNbYV0ueiArIDIwKSk7XG4gIH0pO1xuXG5cbiAgdmFyIGxpbmUgPSBuZXcgVEhSRUUuTGluZShsaW5lR2VvbWV0cnksIG5ldyBUSFJFRS5MaW5lQmFzaWNNYXRlcmlhbCh7XG4gICAgY29sb3I6IDB4MDBmZjAwLFxuICAgIGxpbmV3aWR0aDogNVxuICB9KSk7XG5cblxuICBwbGFuZS5hZGQobGluZSk7XG5cblxuICBzY2VuZS5hZGQocGxhbmUpO1xuXG5cbiAgdmFyIGNvbnRyb2xzID0gbmV3IFRIUkVFLlRyYWNrYmFsbENvbnRyb2xzKGNhbWVyYSk7XG5cbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3dlYmdsJykuYXBwZW5kQ2hpbGQocmVuZGVyZXIuZG9tRWxlbWVudCk7XG5cbiAgcmVuZGVyKCk7XG5cbiAgZnVuY3Rpb24gcmVuZGVyKCkge1xuICAgIGNvbnRyb2xzLnVwZGF0ZSgpO1xuICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZShyZW5kZXIpO1xuICAgIHJlbmRlcmVyLnJlbmRlcihzY2VuZSwgY2FtZXJhKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIG5vcm1hbGl6ZUhlaWdodCh2YWx1ZSwgbm9ybWFsaXplKSB7XG4gICAgaWYoIW5vcm1hbGl6ZSkge1xuICAgICAgcmV0dXJuIHZhbHVlICogMTU7XG4gICAgfVxuXG4gICAgdmFyIHJlc3VsdCA9IE1hdGgucm91bmQodmFsdWUgLyA2NTUzNSAqIDI0NzApO1xuXG4gICAgcmV0dXJuIHJlc3VsdCA+IDAgPyByZXN1bHQgOiB2YWx1ZTtcbiAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBUZXJyYWluO1xuXG4vKmVzbGludC1lbmFibGUgKi9cbiIsIid1c2Ugc3RyaWN0JztcblxubGV0IEFqYXggPSB7XG4gIGdldCh1cmwpIHtcbiAgICAvLyBSZXR1cm4gYSBuZXcgcHJvbWlzZS5cbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgLy8gRG8gdGhlIHVzdWFsIFhIUiBzdHVmZlxuICAgICAgdmFyIHJlcSA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuICAgICAgcmVxLm9wZW4oJ0dFVCcsIHVybCk7XG5cbiAgICAgIHJlcS5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vIFRoaXMgaXMgY2FsbGVkIGV2ZW4gb24gNDA0IGV0Y1xuICAgICAgICAvLyBzbyBjaGVjayB0aGUgc3RhdHVzXG4gICAgICAgIGlmIChyZXEuc3RhdHVzID09PSAyMDApIHtcbiAgICAgICAgICAvLyBSZXNvbHZlIHRoZSBwcm9taXNlIHdpdGggdGhlIHJlc3BvbnNlIHRleHRcbiAgICAgICAgICByZXNvbHZlKHJlcS5yZXNwb25zZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgLy8gT3RoZXJ3aXNlIHJlamVjdCB3aXRoIHRoZSBzdGF0dXMgdGV4dFxuICAgICAgICAgIC8vIHdoaWNoIHdpbGwgaG9wZWZ1bGx5IGJlIGEgbWVhbmluZ2Z1bCBlcnJvclxuICAgICAgICAgIHJlamVjdChFcnJvcihyZXEuc3RhdHVzVGV4dCkpO1xuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICAvLyBIYW5kbGUgbmV0d29yayBlcnJvcnNcbiAgICAgIHJlcS5vbmVycm9yID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZWplY3QoRXJyb3IoJ05ldHdvcmsgRXJyb3InKSk7XG4gICAgICB9O1xuXG4gICAgICAvLyBNYWtlIHRoZSByZXF1ZXN0XG4gICAgICByZXEuc2VuZCgpO1xuICAgIH0pO1xuICB9XG59O1xuXG5leHBvcnQgZGVmYXVsdCBBamF4O1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG5sZXQgTWF0cml4ID0gcmVxdWlyZSgnLi9NYXRyaXgnKTtcblxubGV0IERyb3AgPSB7XG4gIGRyb3BDYWxjdWxhdGlvbihtYXRyaXgsIHRyYWlsKSB7XG4gICAgcmV0dXJuIE1hdHJpeC5nZXRWYWx1ZShtYXRyaXgsIHRyYWlsWzBdKSAtIE1hdHJpeC5nZXRWYWx1ZShtYXRyaXgsIHRyYWlsW3RyYWlsLmxlbmd0aCAtIDFdKTtcbiAgfSxcblxuICBpc0hpZ2hlcihtYXRyaXgsIG5ld1RyYWlsLCBjdXJyZW50VHJhaWwpIHtcbiAgICBsZXQgY3VycmVudERyb3AgPSB0aGlzLmRyb3BDYWxjdWxhdGlvbihtYXRyaXgsIGN1cnJlbnRUcmFpbClcbiAgICAgICwgdHJhaWxEcm9wID0gdGhpcy5kcm9wQ2FsY3VsYXRpb24obWF0cml4LCBuZXdUcmFpbCk7XG5cbiAgICBpZiAobmV3VHJhaWwubGVuZ3RoID09PSBjdXJyZW50VHJhaWwubGVuZ3RoICYmIHRyYWlsRHJvcCA+IGN1cnJlbnREcm9wKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGVsc2UgaWYgKG5ld1RyYWlsLmxlbmd0aCA+IGN1cnJlbnRUcmFpbC5sZW5ndGgpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBEcm9wO1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG5sZXQgUmFuayA9IHJlcXVpcmUoJy4uL2J1cy9SYW5rJyk7XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICBjcmVhdGUobWF0cml4KSB7XG4gICAgbGV0IGxlbmd0aCA9IFJhbmsucmVzdWx0KG1hdHJpeCkubGVuZ3RoO1xuICAgIGxldCBwYXRoID0gUmFuay5nZXQoKTtcblxuICAgIGxldCBoYWxmID0gcGF0aFtNYXRoLmZsb29yKChwYXRoLmxlbmd0aCAtIDEpIC8gMildO1xuXG4gICAgbGV0IHJvd1N0YXJ0ID0gaGFsZlswXSAtIGxlbmd0aDtcbiAgICBpZiAoaGFsZlswXSAtIGxlbmd0aCA8IDApIHtcbiAgICAgIHJvd1N0YXJ0ID0gMDtcbiAgICB9XG5cbiAgICBsZXQgcm93RW5kID0gaGFsZlswXSArIGxlbmd0aDtcbiAgICBpZiAoaGFsZlswXSArIGxlbmd0aCA+IG1hdHJpeC5sZW5ndGggLSAxKSB7XG4gICAgICByb3dFbmQgPSBtYXRyaXgubGVuZ3RoO1xuICAgIH1cblxuICAgIGxldCBjb2xTdGFydCA9IGhhbGZbMV0gLSBsZW5ndGg7XG4gICAgaWYgKGhhbGZbMV0gLSBsZW5ndGggPCAwKSB7XG4gICAgICBjb2xTdGFydCA9IDA7XG4gICAgfVxuXG4gICAgbGV0IGNvbEVuZCA9IGhhbGZbMV0gKyBsZW5ndGg7XG4gICAgaWYgKGhhbGZbMV0gKyBsZW5ndGggPiBtYXRyaXgubGVuZ3RoIC0gMSkge1xuICAgICAgY29sRW5kID0gbWF0cml4Lmxlbmd0aDtcbiAgICB9XG5cbiAgICBsZXQgZ3JpZCA9IFtdO1xuICAgIGxldCBjb3VudCA9IDA7XG4gICAgZm9yIChsZXQgaSA9IHJvd1N0YXJ0OyBpIDwgcm93RW5kOyBpKyspIHtcbiAgICAgIGdyaWRbY291bnRdID0gW107XG4gICAgICBmb3IgKGxldCBqID0gY29sU3RhcnQ7IGogPCBjb2xFbmQ7IGorKykge1xuICAgICAgICBncmlkW2NvdW50XS5wdXNoKG1hdHJpeFtpXVtqXSk7XG4gICAgICB9XG5cbiAgICAgIGNvdW50Kys7XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIHJvd1N0YXJ0LFxuICAgICAgY29sU3RhcnQsXG4gICAgICBncmlkLFxuICAgICAgcGF0aFxuICAgIH07XG4gIH1cbn07XG5cbiIsIid1c2Ugc3RyaWN0JztcblxubW9kdWxlLmV4cG9ydHMgPSB7XG4gIGdldEtleShyb3csIGNvbHVtbikge1xuICAgIHJldHVybiAnXycgKyByb3cgKyAnXycgKyBjb2x1bW47XG4gIH1cbn07XG4iLCIndXNlIHN0cmljdCc7XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICBnZXRWYWx1ZShtYXRyaXgsIGNlbGwpIHtcbiAgICBsZXQgcG9zaXRpb24gPSB0aGlzLmdldFBvc2l0aW9uKGNlbGwpO1xuXG4gICAgcmV0dXJuIG1hdHJpeFtwb3NpdGlvbi5yb3ddW3Bvc2l0aW9uLmNvbHVtbl07XG4gIH0sXG5cbiAgZ2V0UG9zaXRpb24oY2VsbCkge1xuICAgIHJldHVybiB7XG4gICAgICByb3c6IGNlbGxbMF0sXG4gICAgICBjb2x1bW46IGNlbGxbMV1cbiAgICB9O1xuICB9XG59O1xuIl19
